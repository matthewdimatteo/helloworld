pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
-- rider game academy
-- top-down adventure
-- *** pixel-based movement ***
-- by matthew dimatteo

-- tab 0: game loop
-- tab 1: make player
-- tab 2: *** move player ***
-- tab 3: swap sprite

-- runs once at start
function _init()
	big=false -- type of sprite
	make_plyr() -- tab 1
	
	-- target tile coords
	tx=plyr.x
	ty=plyr.y
	tx2=tx
	ty2=ty+plyr.h
end -- /function _init()

-- runs 30x/sec
function _update()
	move_plyr() -- *** tab 2 ***
	
	-- press z to swap sprite
	if btnp(🅾️) then
		swap_sprite() -- tab 3
	end -- /if btnp(🅾️)
	
end -- /function _update()

-- runs 30x/sec
function _draw()
	cls() -- refresh screen
	map() -- draw map
	
	-- draw player
	spr(plyr.n,plyr.x,plyr.y,plyr.w/8,plyr.h/8,plyr.flip)
	
	-- draw target coords as dots
	rect(tx,ty,tx,ty,0) 
	rect(tx2,ty2,tx2,ty2,0) 
 
 -- print the sprite number of
 -- the adjacent map tiles
 print("tiles "..tn1..","..tn2,2,2,7)
 
	-- print flag-checking boolean
	-- values (true if wall)
	if is_wall1 == true then
		print("is_wall1 true",70,2,7)
	elseif is_wall1 == false then
		print("is_wall1 false",70,2,7)
	else
		print("is_wall1 nil",70,2,7)
	end -- /if is_wall1 == true
 
	-- print flag-checking boolean
	-- values (true if wall)
	if is_wall2 == true then
		print("is_wall2 true",70,10,7)
	elseif is_wall2 == false then
		print("is_wall2 false",70,10,7)
	else
		print("is_wall2 nil",70,10,7)
	end -- /if is_wall2 == true
 
	-- print plyr's px coordinates
	print("pixel "..plyr.x..","..(plyr.y),2,10,7)
end -- /function _draw()
-->8
-- make player
function make_plyr()
	plyr = {} -- player object
	
	-- big sprite properties
	if big == true then
	 plyr.n=70 -- sprite number
	 plyr.w=24 -- 24px width
	 plyr.h=24 -- 24px height
	
	-- small sprite properties
	else
		plyr.n=64 -- sprite number
		plyr.w=8 -- 8px width
		plyr.h=8 -- 8px height
	end -- /if/else big
	
	-- x,y pixel coordinates
	plyr.x=16
	plyr.y=24
	
	-- direction
	plyr.flip=false
	plyr.dir=⬇️
	
	-- speed
	plyr.spd=4 -- move 4px/btnp
	
end -- /function make_plyr()
-->8
-- *** move player ***
function move_plyr()

	-- left
	if btnp(⬅️) then
		-- target is 1px left of plyr
		tx=plyr.x-1
		ty=plyr.y
		plyr.dir=⬅️
		
		-- *** check a second point
		-- at bottom of player ***
		tx2=tx
		ty2=plyr.y+plyr.h-1
	end -- /if btnp(⬅️)
	
	-- right
	if btnp(➡️) then
		-- target is 1px right of plyr
		tx=plyr.x+plyr.w
		ty=plyr.y
		plyr.dir=➡️
		
		-- *** check a second point
		-- at bottom of player ***
		tx2=tx
		ty2=plyr.y+plyr.h-1
	end -- /if btnp(➡️)

	-- up
	if btnp(⬆️) then
		-- target is 1px above player
		tx=plyr.x
		ty=plyr.y-1
		plyr.dir=⬆️
		
		-- *** check a second point
		-- on right side of plyr ***
		tx2=plyr.x+plyr.w-1
		ty2=ty
	end -- /if btnp(⬆️)	
	
	-- down
	if btnp(⬇️) then
		-- target is 1px below player
		tx=plyr.x
		ty=plyr.y+plyr.h
		plyr.dir=⬇️
		
		-- *** check a second point
		-- on right side of plyr ***
		tx2=plyr.x+plyr.w-1
		ty2=ty
	end -- /if btnp(⬇️)
	
	-- sprite number of target tile
	-- *** check both points and
	-- divide x,y by 8 to convert
	-- from px to tiles ***
	tn1=mget(flr(tx/8),flr(ty/8))
	tn2=mget(flr(tx2/8),flr(ty2/8))
	
	-- true/false is flag 0 on
	-- for that sprite
	-- *** check both points ***
	is_wall1=fget(tn1,0)
	is_wall2=fget(tn2,0)
	
	-- move to target if no wall
	-- *** at either point ***
	if is_wall1 == false 
	and is_wall2 == false then
	
		-- move left
		if btnp(⬅️) then
			plyr.x-=plyr.spd
		end -- /if btnp(⬅️)
		
		-- move right
		if btnp(➡️) then
			plyr.x+=plyr.spd
		end -- /if btnp(➡️)
		
		-- move up
		if btnp(⬆️) then
			plyr.y-=plyr.spd
		end -- /if btnp(⬆️)
		
		-- move down
		if btnp(⬇️) then
			plyr.y+=plyr.spd
		end -- /if btnp(⬇️)
	
	else 
		-- play bump sound if blocked
		if btn(⬅️) or btn(➡️)
		or btn(⬆️) or btn(⬇️) then
			sfx(0)
		end -- /if btn
		
	end -- /if is_wall1/2 false
	
end -- /function move_plyr()
-->8
-- swap sprite
function swap_sprite()

	-- switch from big to small
	-- and vice-versa
	if big == true then
		big = false
	elseif big == false then
		big = true
	end -- /if big
 
	-- re-initialize the player
	make_plyr() -- tab 1
 
	-- update map collision vars
	tx=plyr.x
	ty=plyr.y
	tx2=tx
	ty2=ty+plyr.h
 
end -- /function swap_sprite
__gfx__
00000000bbbbbbbb3333333333555533bbb33bbbbbb33bbb00000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000bbbbbbbb3333333335555553bb3333bbbb3333bb00000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700bbbbbbbb3be3333355555555b338333bb333333b00000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000bbbbbbbb33b3333355555555333338333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000bbbbbbbb333333eb55555555b383333bb333333b00000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700bbbbbbbb333b33b355555555bb3333bbbb3333bb00000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000bbbbbbbb33eb333335555553bbb44bbbbbb44bbb00000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000bbbbbbbb3333333333555533bbb44bbbbbb44bbb00000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000111111111111111111555511111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000
00000000111111111111111115555551111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000
000000001111111111cc1111555555551111ccc111c1c1c111bbbb11111111110000000000000000000000000000000000000000000000000000000000000000
000000001111111111111111555555551ccc11111c1c1c1111beeb11111111110000000000000000000000000000000000000000000000000000000000000000
00000000111111111111111155555555111111111111111111beeb11111111110000000000000000000000000000000000000000000000000000000000000000
00000000111111111cc1cc11555555551111ccc111c1c1c111bbbb11111111110000000000000000000000000000000000000000000000000000000000000000
000000001111111111111111155555511ccc11111c1c1c1111111111111111110000000000000000000000000000000000000000000000000000000000000000
00000000111111111111111111555511111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000
00000000666666666666666665665665000000000000000000000000000000003333333300000000000000000000000000000000000000000000000000000000
00000000666666666666666655555555000000000000000000000000000000003333333300000000000000000000000000000000000000000000000000000000
00000000666666666656666666566656000000000000000000000000000000009993333300000000000000000000000000000000000000000000000000000000
00000000666666666666656655555555000000000000000000000000000000009a99999900000000000000000000000000000000000000000000000000000000
0000000066666666666666665666566600000000000000000000000000000000939aa9a900000000000000000000000000000000000000000000000000000000
000000006666666666666666555555550000000000000000000000000000000099933a3a00000000000000000000000000000000000000000000000000000000
0000000066666666666656666656656600000000000000000000000000000000aaa3333300000000000000000000000000000000000000000000000000000000
00000000666666666666666655555555000000000000000000000000000000003333333300000000000000000000000000000000000000000000000000000000
00000000999999999999999999444499333333544444444445333333000000000000000000000000000000000000000000000000000000000000000000000000
00000000999999999999999994444449333335444544445444533333000000000000000000000000000000000000000000000000000000000000000000000000
000000009999999999a9999944444444333354444444444444453333000000000000000000000000000000000000000000000000000000000000000000000000
00000000999999999999999944444444333544544445444445445333000000000000000000000000000000000000000000000000000000000000000000000000
00000000999999999999994944444444335444444444445444444533000000000000000000000000000000000000000000000000000000000000000000000000
00000000999999999999999944444444354454444544444444454453000000000000000000000000000000000000000000000000000000000000000000000000
00000000999999999699999994444449544444544444544444444445000000000000000000000000000000000000000000000000000000000000000000000000
00000000999999999999999999444499445444444444444445444544000000000000000000000000000000000000000000000000000000000000000000000000
000440000004400000044000000440000004400000044000aaaaaaaaaaaaaaaaaaaaaaaa00000000b7b7b7b7b7b737b7b7b7b7bb000000000000000000000000
000990000004400000099000000990000009900000099000aaaaaaaaaaaaaaaaaaaaaaaa000000007bbbbbbbbb3333bbbbbbbbb7000000000000000000000000
000990000009900000099000000990000009900000099000aaaaccccccccccccccccaaaa00000000bbbbbbbbb333333bbbbbbbbb000000000000000000000000
088888800888888000088000000880000008800000088000aaaccccccccccccccccccaaa000000007bbbbbbb33333333bbbbbbb7000000000000000000000000
808888088088880800088800000880000008800000088000aaccccccccccccccccccccaa00000000bbbbbbb3333333333bbbbbbb000000000000000000000000
00cccc0000cccc00000cc000000c80000008c000000c8000aacccc444cccccc444ccccaa000000007bbbbb333333333333bbbbb7000000000000000000000000
00c00c0000c00c00000cc000000cc000000cc000000cc000aacccc777cccccc777ccccaa00000000bbbbb33333333333333bbbbb000000000000000000000000
00c00c0000c00c00000cc000000cc000000cc000000cc000aacccc747cccccc747ccccaa000000007bbb3333333333333333bbb7000000000000000000000000
000000000000000000000000000000000000000000000000aacccc777cccccc777ccccaa00000000bbb333333333333333333bbb000000000000000000000000
000000000000000000000000000000000000000000000000aaccccccccccccccccccccaa000000007b33333333333333333333b7000000000000000000000000
000000000000000000000000000000000000000000000000aaccccccccccccccccccccaa00000000b3333333333333333333333b000000000000000000000000
000000000000000000000000000000000000000000000000aaccccccccccccccccccccaa00000000733333333333333333333337000000000000000000000000
000000000000000000000000000000000000000000000000aaccccccccccccccccccccaa00000000b33333333333333333333333000000000000000000000000
000000000000000000000000000000000000000000000000aaccccccc888888cccccccaa00000000733333333333333333333337000000000000000000000000
000000000000000000000000000000000000000000000000aacccccc88555588ccccccaa00000000bb33333333333333333333bb000000000000000000000000
000000000000000000000000000000000000000000000000aacccccc85555558ccccccaa000000007bb333333333333333333bb7000000000000000000000000
000000000000000000000000000000000000000000000000aacccccc85555558ccccccaa00000000bbbb3333333443333333bbbb000000000000000000000000
000000000000000000000000000000000000000000000000aacccccc88555588ccccccaa000000007bbbb33333444433333bbbb7000000000000000000000000
000000000000000000000000000000000000000000000000aaccccccc888888cccccccaa00000000bbbbbb333444444333bbbbbb000000000000000000000000
000000000000000000000000000000000000000000000000aaccccccccccccccccccccaa000000007bbbbbbbbb4444bbbbbbbbb7000000000000000000000000
000000000000000000000000000000000000000000000000aaaccccccccccccccccccaaa00000000bbbbbbbbbb4444bbbbbbbbbb000000000000000000000000
000000000000000000000000000000000000000000000000aaaaccccccccccccccccaaaa000000007bbbbbbbbb4444bbbbbbbbb7000000000000000000000000
000000000000000000000000000000000000000000000000aaaaaaaaaaaaaaaaaaaaaaaa00000000bbbbbbbbbb4444bbbbbbbbbb000000000000000000000000
000000000000000000000000000000000000000000000000aaaaaaaaaaaaaaaaaaaaaaaa00000000b7b7b7b7b74747b7b7b7b7b7000000000000000000000000
__gff__
0000000103010000000000000000000000010101030502850000000000000000000000012000000000000000000000000000000101010100000000000000000000000000000000000000010101000000000000000000000000000101010000000000000000000000000001010100000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
1717171717171717171717171717171700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1717171717171717171717171717171700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0501010101010101010101010101010500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0501010101010101010101010101010500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0501010101010101010101010101010500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0501010101014a4b4c0101010101010500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0501010101015a5b5c0101010101010500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0501010101016a6b6c0101010101010500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0501010101010101010101010101010500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0501010101010101010101010101010500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0501010101010101010101010101010500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0501010101010101010101010101010500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0501010101010101010101010101010500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0501010101010101010101010101010500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000400000c05000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000500002a05035050350500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00050000277502c750317503375037750000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
